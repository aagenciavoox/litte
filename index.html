<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Sistema LittÃª v4.0</title>

    <!-- Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>

    <style>
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif;
        }
        .fade-in {
            animation: fadeIn 0.3s ease-in;
        }
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(-10px); }
            to { opacity: 1; transform: translateY(0); }
        }
    </style>
</head>
<body class="bg-gray-50 min-h-screen">

    <!-- Container Principal -->
    <div class="container mx-auto px-4 py-8 max-w-4xl">

        <!-- Header -->
        <header class="mb-8 text-center">
            <h1 class="text-4xl font-bold text-gray-900 mb-2">Sistema LittÃª v4.0</h1>
            <p class="text-gray-600">VersÃ£o MÃ­nima ViÃ¡vel - ReconstruÃ­da do Zero</p>
        </header>

        <!-- Status Card -->
        <div class="bg-white rounded-lg shadow-md p-6 mb-6">
            <h2 class="text-xl font-semibold text-gray-800 mb-4">Status do Sistema</h2>
            <div id="status-info" class="space-y-2 text-gray-600">
                <p>â³ Aguardando inicializaÃ§Ã£o...</p>
            </div>
        </div>

        <!-- AÃ§Ãµes -->
        <div class="bg-white rounded-lg shadow-md p-6 mb-6">
            <h2 class="text-xl font-semibold text-gray-800 mb-4">AÃ§Ãµes</h2>
            <div class="flex gap-4">
                <button
                    id="btn-testar"
                    class="bg-blue-600 hover:bg-blue-700 text-white font-semibold px-6 py-3 rounded-lg transition-colors">
                    Testar ConexÃ£o Backend
                </button>
                <button
                    id="btn-estatisticas"
                    class="bg-green-600 hover:bg-green-700 text-white font-semibold px-6 py-3 rounded-lg transition-colors">
                    Carregar EstatÃ­sticas
                </button>
            </div>
        </div>

        <!-- Resultado -->
        <div id="resultado-container" class="hidden">
            <div class="bg-white rounded-lg shadow-md p-6">
                <h2 class="text-xl font-semibold text-gray-800 mb-4">Resultado</h2>
                <pre id="resultado" class="bg-gray-100 p-4 rounded text-sm overflow-x-auto"></pre>
            </div>
        </div>

    </div>

    <!-- JavaScript -->
    <script>
        /**
         * â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
         * INICIALIZAÃ‡ÃƒO SEGURA
         * â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
         */

        let appReady = false;

        // Aguardar DOM carregar
        document.addEventListener('DOMContentLoaded', function() {
            console.log('âœ… DOM carregado');
            inicializarApp();
        });

        /**
         * Inicializa a aplicaÃ§Ã£o de forma segura
         */
        function inicializarApp() {
            // Verificar se google.script estÃ¡ disponÃ­vel
            if (typeof google === 'undefined' || typeof google.script === 'undefined') {
                console.warn('â³ google.script nÃ£o disponÃ­vel ainda, tentando novamente...');
                setTimeout(inicializarApp, 100);
                return;
            }

            console.log('âœ… google.script disponÃ­vel');
            appReady = true;

            // Atualizar status
            document.getElementById('status-info').innerHTML = `
                <p class="text-green-600 font-semibold">âœ… Sistema inicializado com sucesso</p>
                <p class="text-sm text-gray-500">google.script.run disponÃ­vel</p>
                <p class="text-sm text-gray-500">Pronto para interagir com backend</p>
            `;

            // Configurar event listeners
            configurarEventos();
        }

        /**
         * â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
         * EVENT LISTENERS
         * â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
         */

        function configurarEventos() {
            // BotÃ£o testar conexÃ£o
            document.getElementById('btn-testar').addEventListener('click', function() {
                testarConexao();
            });

            // BotÃ£o estatÃ­sticas
            document.getElementById('btn-estatisticas').addEventListener('click', function() {
                carregarEstatisticas();
            });
        }

        /**
         * â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
         * FUNÃ‡Ã•ES DE INTERAÃ‡ÃƒO COM BACKEND
         * â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
         */

        /**
         * Testa a conexÃ£o com o backend
         */
        function testarConexao() {
            if (!appReady) {
                mostrarErro('Sistema ainda nÃ£o estÃ¡ pronto. Aguarde...');
                return;
            }

            mostrarLoading('Testando conexÃ£o...');

            google.script.run
                .withSuccessHandler(function(resultado) {
                    console.log('âœ… Resposta recebida:', resultado);
                    mostrarResultado(resultado);
                })
                .withFailureHandler(function(erro) {
                    console.error('âŒ Erro:', erro);
                    mostrarErro('Erro ao conectar: ' + erro.message);
                })
                .testarConexao();
        }

        /**
         * Carrega estatÃ­sticas do backend
         */
        function carregarEstatisticas() {
            if (!appReady) {
                mostrarErro('Sistema ainda nÃ£o estÃ¡ pronto. Aguarde...');
                return;
            }

            mostrarLoading('Carregando estatÃ­sticas...');

            google.script.run
                .withSuccessHandler(function(resultado) {
                    console.log('âœ… EstatÃ­sticas recebidas:', resultado);
                    mostrarResultado(resultado);
                })
                .withFailureHandler(function(erro) {
                    console.error('âŒ Erro:', erro);
                    mostrarErro('Erro ao carregar estatÃ­sticas: ' + erro.message);
                })
                .getEstatisticas();
        }

        /**
         * â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
         * FUNÃ‡Ã•ES DE UI
         * â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
         */

        /**
         * Mostra estado de loading
         */
        function mostrarLoading(mensagem) {
            const container = document.getElementById('resultado-container');
            const resultado = document.getElementById('resultado');

            container.classList.remove('hidden');
            container.classList.add('fade-in');
            resultado.className = 'bg-blue-50 border-2 border-blue-200 p-4 rounded text-blue-800';
            resultado.textContent = 'â³ ' + mensagem;
        }

        /**
         * Mostra resultado de sucesso
         */
        function mostrarResultado(dados) {
            const container = document.getElementById('resultado-container');
            const resultado = document.getElementById('resultado');

            container.classList.remove('hidden');
            container.classList.add('fade-in');
            resultado.className = 'bg-green-50 border-2 border-green-200 p-4 rounded text-sm overflow-x-auto';
            resultado.textContent = JSON.stringify(dados, null, 2);
        }

        /**
         * Mostra mensagem de erro
         */
        function mostrarErro(mensagem) {
            const container = document.getElementById('resultado-container');
            const resultado = document.getElementById('resultado');

            container.classList.remove('hidden');
            container.classList.add('fade-in');
            resultado.className = 'bg-red-50 border-2 border-red-200 p-4 rounded text-red-800';
            resultado.textContent = 'âŒ ' + mensagem;
        }

        // Log inicial
        console.log('ğŸ“¦ Script carregado - aguardando DOMContentLoaded');
    </script>

</body>
</html>
